import logging
import sys

import numpy as np
from numpy import ndarray

from utils import audio_calcs

logger = logging.getLogger(__name__)
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s [%(levelname)s]:\n %(message)s",
    handlers=[
        logging.StreamHandler(sys.stdout)
    ]
)

input_frequency_spectrum_magnitudes = [
    0.009365159086883068,
    0.006315268110483885,
    0.012344480492174625,
    0.0051973117515444756,
    0.010001206770539284,
    0.0030329907312989235,
    0.011420179158449173,
    0.008953680284321308,
    0.009195424616336823,
    0.005062267649918795,
    0.006275476422160864,
    0.005107547622174025,
    0.00536464573815465,
    0.003697829321026802,
    0.003761296160519123,
    0.0026206111069768667,
    0.003395063802599907,
    0.0051921964623034,
    0.00519573362544179,
    0.0033291729632765055,
    0.0044568609446287155,
    0.0037290535401552916,
    0.0028761602006852627,
    0.004773058462888002,
    0.004973577335476875,
    0.0037337385583668947,
    0.0008460328681394458,
    0.0006842413567937911,
    0.0011519944528117776,
    0.0021663119550794363,
    0.0020241502206772566,
    0.0014178772689774632,
    0.0013473269063979387,
    0.0013501845533028245,
    0.0008883357513695955,
    0.0010637897066771984,
    0.0008413843461312354,
    0.00040912258555181324,
    0.0007013297872617841,
    0.0004859342589043081,
    0.00029137986712157726,
    0.00012469214561861008,
    0.0003509787784423679,
    0.0008595862309448421,
    0.0007656914531253278,
    0.000494425417855382,
    0.0003712211037054658,
    0.00034861027961596847,
    0.00018157005251850933,
    0.0004813238338101655,
    0.0007102261879481375,
    0.0003009582869708538,
    0.00021088293578941375,
    0.00021501626179087907,
    0.00016554597823414952,
    0.0003966118092648685,
    0.0003899357980117202,
    0.00013854207645636052,
    0.000236549909459427,
    0.0002614869154058397,
    6.327981100184843e-05,
    0.00019392513786442578,
    0.00030995148699730635,
    0.0003181001520715654,
    0.0002171980304410681,
    0.0002634181873872876,
    0.00044900798820890486,
    0.00017361533537041396,
    0.00027809178573079407,
    0.0002829406876116991,
    0.0002020849788095802,
    0.0002965922758448869,
    0.0007010483532212675,
    0.0004577388463076204,
    9.143478382611647e-05,
    8.617302955826744e-05,
    0.00019292935030534863,
    0.00020000289077870548,
    0.00018466077744960785,
    0.00028340009157545865,
    0.00019471427367534488,
    3.592788925743662e-05,
    0.00011639390140771866,
    0.00013089673302602023,
    0.00019772576342802495,
    0.0001059398491634056,
    0.0002861354441847652,
    0.0003514970594551414,
    0.0002790821308735758,
    0.0006310351309366524,
    0.0005956725217401981,
    0.00016499334014952183,
    0.00022273918148130178,
    0.00011687749065458775,
    0.00019511714344844222,
    0.00023911012976896018,
    0.00025514294975437224,
    0.00047284079482778907,
    0.0004021302447654307,
    0.00030492202495224774,
    8.278698078356683e-05,
    0.0001395082363160327,
    0.00012666564725805074,
    7.314058893825859e-05,
    0.00017198926070705056,
    0.00014131040370557457,
    0.00017421993834432214,
    0.00025986949913203716,
    0.0003073975967708975,
    0.00022650770551990718,
    0.00034884311025962234,
    0.0002685499202925712,
    0.000253327569225803,
    0.00025129562709480524,
    0.00014991126954555511,
    0.0003413365047890693,
    0.00021281377121340483,
    0.00010750878573162481,
    0.00018211682618129998,
    0.0002206398785347119,
    0.00018042010196950287,
    8.56524784467183e-05,
    0.00021984482009429485,
    0.00012205055827507749,
    0.0002371613372815773,
    0.0005423685070127249,
    0.0006198965711519122,
    0.000144616438774392,
    0.00047406263183802366,
    0.00037975143641233444,
    0.000600100087467581,
    0.0009970396058633924,
    0.0011938209645450115,
    0.000760002585593611,
    0.00022981897927820683,
    0.0003437236591707915,
    0.000712508917786181,
    0.0009068967774510384,
    0.0004868897085543722,
    0.0003652944869827479,
    0.0006130901165306568,
    0.00045981313451193273,
    0.00014481646940112114,
    0.0002133897942258045,
    0.0002556256949901581,
    0.00010732689406722784,
    6.549922545673326e-05,
    0.00012919207802042365,
    0.0002921203267760575,
    0.00018902082229033113,
    0.00025271886261180043,
    0.00046952223055996,
    0.00032121301046572626,
    0.00010539821232669055,
    0.0002035992220044136,
    0.00025058441678993404,
    0.00022705693845637143,
    0.0006003087037242949,
    0.0003400608547963202,
    0.00033540549338795245,
    0.00033552880631759763,
    0.000479203270515427,
    0.0005178781575523317,
    0.000349920941516757,
    0.0004420819750521332,
    0.0002683407801669091,
    0.00039789945003576577,
    0.0005654465057887137,
    0.0005173361278139055,
    0.00028614391339942813,
    0.0002468771708663553,
    0.00012392796634230763,
    0.00045829714508727193,
    0.0006648629205301404,
    0.0004812766273971647,
    0.0001786415814422071,
    0.000242907291976735,
    0.0002470129111316055,
    0.00022900912154000252,
    0.00010675553494365886,
    9.209911513607949e-05,
    0.00013996401685290039,
    0.00014643091708421707,
    0.00022098826593719423,
    0.00019279042317066342,
    5.810125367133878e-05,
    0.00016000482719391584,
    0.00016007704834919423,
    4.359742160886526e-05,
    0.00015573245764244348,
    0.0002475522051099688,
    0.00023558428802061826,
    0.00015502249880228192,
    8.761270146351308e-05,
    0.0003155247832182795,
    0.0002340414357604459,
    1.1613114111241885e-05,
    1.5890916984062642e-05,
    0.00012486240302678198,
    0.0001829360262490809,
    0.0002360626240260899,
    0.00024588117958046496,
    0.00012061247252859175,
    0.00014157484110910445,
    0.00019761802104767412,
    9.73965143202804e-05,
    6.759833195246756e-05,
    8.474884816678241e-05,
    0.00022455936414189637,
    0.00024681922513991594,
    0.00012055852130288258,
    7.5017727795057e-05,
    0.00016440315812360495,
    0.0001718684652587399,
    0.00024046430189628154,
    0.00022664312564302236,
    0.0001694873790256679,
    2.4338782168342732e-05,
    0.00016991989105008543,
    9.987126395571977e-05,
    0.00012169265392003581,
    0.00028087719692848623,
    0.00033126099151559174,
    0.000300692772725597,
    0.0002602144959382713,
    0.000168778162333183,
    7.54180655349046e-05,
    0.00019153048924636096,
    0.0001489500718889758,
    0.00012852989311795682,
    0.0002115707320626825,
    0.0002609373477753252,
    0.00022163383255247027,
    0.00010959489736706018,
    0.0001673404040047899,
    0.00038688999484293163,
    0.0005291475681588054,
    0.00023499461531173438,
    0.0001970280718524009,
    8.582811278756708e-05,
    0.00023632719239685684,
    0.00026787020033225417,
    0.0002666045620571822,
    0.00010131289309356362,
    8.0185491242446e-05,
    0.0002853518817573786,
    0.0002112637594109401,
    0.00028296236996538937,
    0.00021410553017631173,
    9.834114462137222e-05,
    1.9040175175177865e-05,
    6.969040259718895e-05,
    0.0002419453812763095,
    0.00037008081562817097,
    0.0003674884501378983,
    0.00018190128321293741,
    7.207965973066166e-05,
    0.00018303838442079723,
    0.000315735989715904,
    0.0003670987207442522,
    0.0002991744258906692,
    8.965271263150498e-05,
    0.00014275711146183312,
    7.599248056067154e-05,
    0.00011623506725300103,
    0.00021895798272453249,
    0.0001634641084820032,
    0.00013478817709255964,
    0.0001949560537468642,
    0.00017436248890589923,
    0.00013478667824529111,
    0.0002733574074227363,
    0.0001878980256151408,
    0.0001096617488656193,
    9.919681178871542e-05,
    5.049253013567068e-05,
    0.0001362627517664805,
    0.0001803809282137081,
    0.0001402776106260717,
    0.0001440561463823542,
    0.00017695156566333026,
    0.0002666174550540745,
    0.00018354620260652155,
    8.917085506254807e-05,
    0.0002922781277447939,
    0.00033908855402842164,
    0.00031532207503914833,
    0.0003115679428447038,
    9.047489584190771e-05,
    0.00012808555038645864,
    7.593423651997e-05,
    0.00017228510114364326,
    0.00013370238593779504,
    0.00017286947695538402,
    0.0001404950744472444,
    0.00016281241551041603,
    8.496116060996428e-05,
    2.8614635084522888e-05,
    3.194804594386369e-05,
    9.491049422649667e-05,
    0.0001835736766224727,
    0.00025181283126585186,
    0.00019549869466573,
    0.00016528541164007038,
    1.4228229474610998e-06,
    0.00019405584316700697,
    0.00016890816914383322,
    8.236941357608885e-05,
    3.453786484897137e-05,
    9.981790935853496e-05,
    9.747256990522146e-05,
    0.00016739830607548356,
    0.00018604511569719762,
    3.5515222407411784e-05,
    0.0002614858094602823,
    0.00038226545439101756,
    0.00022894065477885306,
    3.270018351031467e-05,
    0.00011284645734122023,
    5.411313031800091e-05,
    0.00011326048843329772,
    0.0003476626880001277,
    0.0003063971525989473,
    0.00020405267423484474,
    0.0003848554042633623,
    0.0003627548285294324,
    0.0003319779643788934,
    3.861548248096369e-05,
    0.0002947990142274648,
    0.00017683609621599317,
    3.294522684882395e-05,
    0.0001330873346887529,
    0.0002480696712154895,
    0.0002242415357613936,
    0.00018480732978787273,
    0.00024547253269702196,
    0.000297922728350386,
    0.00019047170644626021,
    9.64813370956108e-05,
    2.1367473891586997e-05,
    5.2273364417487755e-05,
    0.00014427106361836195,
    0.0001812185946619138,
    0.0003189393610227853,
    0.00034751411294564605,
    0.00018158616148866713,
    5.100684575154446e-05,
    0.00015429500490427017,
    0.0001941426598932594,
    0.00023962250270415097,
    0.00038508509169332683,
    0.0001888686529127881,
    0.00020159484120085835,
    0.00014684352208860219,
    6.766615115338936e-05,
    6.078141450416297e-05,
    0.00023125090228859335,
    0.0002543559530749917,
    0.0001043798474711366,
    0.00015006396279204637,
    7.870338595239446e-05,
    0.00019069174595642835,
    0.0002195672132074833,
    0.00014011260645929724,
    0.00012652720033656806,
    0.00013512471923604608,
    0.00010154615301871672,
    0.00015772391634527594,
    0.0002638517180457711,
    0.0001741479936754331,
    0.00014608698256779462,
    0.00015386263839900494,
    0.0001282217854168266,
    0.0002974891976919025,
    0.00031947289244271815,
    0.00028911285335198045,
    0.00026691885432228446,
    0.0001850236440077424,
    0.00021714814647566527,
    7.962590461829677e-05,
    0.00015876399993430823,
    0.0001124791378970258,
    3.244212712161243e-05,
    0.0001721165463095531,
    0.00037942419294267893,
    0.0003551392292138189,
    0.0003063309704884887,
    0.00035936542553827167,
    0.00023872505698818713,
    0.00016139335639309138,
    0.00011266046203672886,
    8.447340951533988e-05,
    0.00012249233259353787,
    0.00023944386339280754,
    0.00026658442220650613,
    6.115336873335764e-05,
    0.00019193856860511005,
    8.690713002579287e-05,
    0.00022880855249240994,
    0.0001274416717933491,
    7.972294406499714e-05,
    0.00010587027645669878,
    0.00010345136251999065,
    0.00026538895326666534,
    0.00025158864445984364,
    0.00018367393931839615,
    8.105936285573989e-05,
    0.00014836252375971526,
    8.006219286471605e-05,
    8.277666347566992e-05,
    9.960016905097291e-05,
    9.245520050171763e-05,
    7.564782572444528e-05,
    6.957340519875288e-05,
    7.692859799135476e-05,
    0.00014214539260137826,
    0.00021829565230291337,
    0.00010976786143146455,
    0.0001584342389833182,
    0.00018544124031905085,
    0.00020075999782420695,
    0.00013815292913932353,
    0.00010542461677687243,
    6.667647539870813e-05,
    7.741423178231344e-05,
    0.0001880969648482278,
    0.0003027241909876466,
    0.0002969809283968061,
    0.00033887792960740626,
    0.00011913401249330491,
    0.00010139576625078917,
    0.00020721039618365467,
    0.00017293637210968882,
    0.0002841030072886497,
    8.415928459726274e-05,
    5.767007314716466e-05,
    9.832470095716417e-05,
    8.40034190332517e-05,
    2.7831247280118987e-05,
    5.152872472535819e-05,
    8.043928391998634e-05,
    5.81571293878369e-05,
    0.00012736830103676766,
    8.868669829098508e-05,
    3.399065462872386e-05,
    0.0001784759369911626,
    0.00028054663562215865,
    0.00020219931320752949,
    7.407155499095097e-05,
    0.00013504058006219566,
    4.701657599071041e-05,
    7.57815214456059e-05,
    5.047871309216134e-05,
    8.004860865185037e-05,
    5.6469561968697235e-05,
    0.00016462511848658323,
    0.00018621447088662535,
    8.672615513205528e-05,
    6.020454748068005e-05,
    3.082891635131091e-05,
    7.795989949954674e-05,
    4.080310100107454e-05,
    0.00013003620551899076,
    0.00012047454947605729,
    3.097394437645562e-05,
    7.08910811226815e-05,
    8.631676610093564e-05,
    5.5742650147294626e-05,
    3.1107923859963194e-05,
    3.608462429838255e-05,
    6.302938709268346e-05,
    5.273448914522305e-05,
    0.00011859129153890535,
    0.00011899152741534635,
    5.379227513913065e-05,
    4.686607644543983e-05,
    6.857130210846663e-05,
    0.00010579087393125519,
    8.01942587713711e-05,
    1.529342625872232e-05,
    5.193011020310223e-05,
    6.605611997656524e-05,
    3.9965299947652966e-05,
    3.937023939215578e-05,
    4.6241872041719034e-05,
    4.2846313590416685e-05,
    4.021751010441221e-05,
    4.997813448426314e-05,
    3.228589775972068e-05,
    6.737702642567456e-05,
    5.2126746595604345e-05,
    6.968859088374302e-05,
    3.212675073882565e-05,
    1.535132287244778e-05,
    3.277248833910562e-05,
    4.539420842775144e-05,
    4.413451824802905e-05,
    5.7764933444559574e-05,
    5.072494604974054e-05,
    2.8911174013046548e-05,
    2.8425283744581975e-05,
    3.103259950876236e-05,
    1.2425622117007151e-05,
    4.966663254890591e-06,
    2.1851228666491807e-05,
    3.0021063139429316e-05,
    1.0641168046277016e-05,
    1.0945803296635859e-05,
    1.2732443792629056e-05,
    1.1206758244952653e-05,
    1.2547668120532762e-05,
    1.8329967133468017e-05
]


def get_rms(numbers: ndarray) -> ndarray:
    return np.sqrt(np.mean(numbers ** 2))


def main():
    logger.info('Input')
    logger.info(input_frequency_spectrum_magnitudes)

    logger.info('Calc dBs')
    dbs = audio_calcs.magnitude_to_db(input_frequency_spectrum_magnitudes)
    logger.info('dBs')
    logger.info(dbs)

    db = audio_calcs.calc_total_sound_level(dbs=dbs)
    logger.info(f'Using Total Sound Level: {db}')
    db = audio_calcs.calc_average_sound_level(dbs=dbs)
    logger.info(f'Using Average Sound Level: {db}')
    db = audio_calcs.calc_db_from_frequency_dbs(dbs=dbs)
    logger.info(f'Using Root Mean Square: {db}')


if __name__ == '__main__':
    main()
